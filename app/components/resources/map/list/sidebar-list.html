<div *ngIf="listPopoverOpened" id="sidebar-popover">

    <div *ngIf="childrenMenuOpened"
         (click)="viewFacade.moveInto(viewFacade.getSelectedDocument())"
         class="btn btn-light"
         style="opacity: 0.8; font-size: 12px; color: gray">
        <span class="mdi mdi-chevron-double-left"></span>Kollektion öffnen
    </div>

    <div *ngIf="childrenMenuOpened && children.length > 0" class=""
         style="opacity: 0.8; font-size: 12px; color: gray; position: absolute; top: 7px; right: 9px;">
        <span *ngIf="children.length === 1">1 Ressource</span>
        <span *ngIf="children.length > 1">{{children.length}} Ressourcen</span>
    </div>

    <ul *ngIf="childrenMenuOpened"
        class="overlay-list resources-listing">

        <li *ngFor="let document of children"
            (click)="moveIntoAndSelect(document)"
            (dblclick)="resourcesComponent.editDocument(document, 'fields')"
            (contextmenu)="openContextMenu($event, document)"
            class="resources-listing-item resources-listing-item-slim"
            [class.new-from-remote]="viewFacade.isNewDocumentFromRemote(document)"
            [class.conflicted]="document['_conflicts']"
            [class.selected]="viewFacade.getSelectedDocument()
                    && viewFacade.getSelectedDocument().resource.id === document.resource.id"
            [id]="'resource-' + document.resource.identifier">

            <document-teaser [document]="document"></document-teaser>
        </li>
    </ul>

    <relations-view
            *ngIf="relationsMenuOpened && viewFacade.getSelectedDocument()"
            class="resources-listing"
            [resource]="viewFacade.getSelectedDocument().resource"
            (onRelationTargetClicked)="jumpToResource($event)"
            [hideRelations]="relationsToHide">
    </relations-view>

    <document-view-sidebar *ngIf="infoMenuOpened"></document-view-sidebar>
</div>


<ul id="sidebar" class="resources-listing"
    (mouseleave)="highlightedDocument = undefined"
    (scroll)="closeContextMenu()">
    <li *ngFor="let document of viewFacade.getDocuments()"
        class="resources-listing-item resources-listing-item-wide"
        (mouseover)="highlightDocument(document)"
        (contextmenu)="openContextMenu($event, document)"
        [class.new-from-remote]="viewFacade.isNewDocumentFromRemote(document)"
        [class.conflicted]="document['_conflicts']"
        [class.selected]="viewFacade.getSelectedDocument()
                && viewFacade.getSelectedDocument().resource.id === document.resource.id"
        [id]="'resource-' + document.resource.identifier">

        <sidebar-list-button-group [document]="document"></sidebar-list-button-group>

        <document-teaser
                (click)="select(document)"
                (dblclick)="resourcesComponent.editDocument(document, 'fields')"
                [document]="document"></document-teaser>
    </li>

    <li *ngIf="isDocumentLimitExceeded()" id="document-limit-info" i18n="@@resources.sidebarList.resourceLimitInfo">
        Es werden die ersten {{viewFacade.getDocuments().length}} von {{viewFacade.getTotalDocumentCount()}}
        Ressourcen angezeigt. Schränken Sie die Suche weiter ein oder verlassen Sie den erweiterten Suchmodus,
        um auf die übrigen Ressourcen zuzugreifen.
        <br><br><br>
    </li>
</ul>

<plus-button *ngIf="isPlusButtonShown()" id="create-document-button" [placement]="'top'"
             [preselectedType]="getCurrentFilterType()"
             [liesWithin]="getSelectedSegmentDoc()"
             [isRecordedIn]="viewFacade.getCurrentOperation()"
             [status]="getPlusButtonStatus()"></plus-button>
<loading-icon></loading-icon>