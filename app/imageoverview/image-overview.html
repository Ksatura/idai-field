<ng-template #deleteModal let-c="close">
    <div class="modal-body">
        <p *ngIf="selected.length > 1">Möchten Sie die {{selected.length}} markierten Bilder wirklich löschen?</p>
        <p *ngIf="selected.length == 1">Möchten Sie das markierte Bild wirklich löschen?</p>
    </div>
    <div class="modal-footer">
        <button type="button" id="delete-images-confirm" class="btn btn-danger" (click)="c('delete')">Löschen</button>
        <button type="button" id="delete-images-cancel" class="btn btn-secondary" (click)="c('cancel')">Abbrechen</button>
    </div>
</ng-template>

<div class="image-overview row">

    <div class="col-sm-12"
         (dragover)="false"
         (dragleave)="false"
         (drop)="false">

        <div class="row bg-light image-overview-nav">
            <div *ngIf="!selected.length" class="col-sm-7 py-2">
                <search-bar *ngIf="imagesState.getQuery()" [q]="imagesState.getQuery().q"
                            [types]="imagesState.getQuery().types" [parentType]="'Image'" [hidden]="selected.length"
                            (onQueryStringChanged)="setQueryString($event)" (onTypesChanged)="setQueryTypes($event)">
                </search-bar>
            </div>

            <div *ngIf="!selected.length" class="col-sm-3 py-2">
                <select id="main-type-document-filter-select" class="form-control"
                        [ngModel]="imagesState.mainTypeDocumentFilterOption"
                        (ngModelChange)="chooseMainTypeDocumentFilterOption($event)">
                    <option value=""><em>Alle Bilder</em></option>
                    <option value="UNLINKED"><em>Unverknüpfte Bilder</em></option>
                    <option *ngFor="let document of mainTypeDocuments" value="{{document.resource.id}}">
                        {{viewUtility.getDocumentLabel(document)}}
                    </option>
                </select>
            </div>

            <div *ngIf="selected.length" class="col-sm-10 py-2">
                <div id="image-overview-buttons" class="btn-toolbar">
                    <div class="btn-group mr-2" role="group">
                        <button type="button" id="delete-images" class="btn btn-danger"
                                (click)="openDeleteModal(deleteModal)"
                                placement="bottom" container="body"
                                ngbTooltip="Löschen">
                            <span class="mdi mdi-delete"></span>
                        </button>
                    </div>
                    <div class="btn-group mr-2" role="group">
                        <button *ngIf="depictsRelationsSelected" type="button" id="remove-link-btn"
                                class="btn btn-danger" (click)="openRemoveLinkModal()"
                                placement="bottom" container="body"
                                ngbTooltip="Verknüpfungen entfernen">
                            <span class="mdi mdi-link-off"></span>
                        </button>
                        <button type="button" id="create-link-btn" class="btn btn-primary"
                                (click)="openLinkModal(linkModal)"
                                placement="bottom" container="body"
                                ngbTooltip="Verknüpfen">
                            <span class="mdi mdi-link"></span>
                        </button>
                    </div>
                    <div class="btn-group">
                        <button id="deselect-images" type="button" class="btn btn-secondary" (click)="clearSelection()">
                            Auswahl aufheben
                        </button>
                    </div>
                </div>
            </div>

            <div class="col-sm-2 text-right py-3 slider-container">
                <span id="decrease-grid-size-button" class="mdi mdi-view-grid align-middle"
                      (click)="setGridSize(imagesState.getGridSize()-1)"></span>
                <input id="grid-size-slider" #gridSize type="range" min="{{minGridSize}}"
                       max="{{maxGridSize}}" value="{{imagesState.getGridSize()}}"
                       class="slider align-middle"
                       (change)="setGridSize(gridSize.value)">
                <span id="increase-grid-size-button" class="mdi mdi-apps align-middle"
                      (click)="setGridSize(imagesState.getGridSize()+1)"></span>
            </div>
        </div>

        <div id="image-count-badge" class="badge badge-secondary">
            {{documents ? documents.length - 1 : 0}} von {{totalImageCount}}
            <span *ngIf="totalImageCount == 1">Bild wird</span>
            <span *ngIf="totalImageCount != 1">Bildern werden</span>
            angezeigt
        </div>

        <div (window:resize)="onResize($event)">
            <image-grid #imageGrid
                    [nrOfColumns]="imagesState.getGridSize()"
                    [documents]="documents"
                    [resourceIdentifiers]="resourceIdentifiers"
                    [selected]="selected"
                    [showDropArea]="true"
                    [showGeoIcon]="true"
                    [showTooltips]="true"
                    (onClick)="select($event)"
                    (onDoubleClick)="navigateTo($event)"
                    (onImagesUploaded)="resetSearch(); refreshGrid();">
            </image-grid>
        </div>

    </div>
</div>