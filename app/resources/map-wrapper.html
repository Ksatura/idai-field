<div class="row map-wrapper">
    <div class="col-lg-3 col-md-3 col-sm-3" id="objectOverview">
        <ul class="list-group object-list" id="objectList">
            <li *ngFor="let document of documents; let index=index"
                (click)="resourcesComponent.select(document)"
                (dblclick)="resourcesComponent.editDocument(document)"
                class="list-group-item"
                [class.new-from-remote]="resourcesComponent.isNewDocumentFromRemote(document)"
                [class.conflicted]="document['_conflicts']"
                [class.selected]="resourcesComponent.getSelected()
                    && resourcesComponent.getSelected().resource.id === document.resource.id"
                [id]="'resource-' + document.resource.identifier">

                <document-teaser [document]="document"></document-teaser>
            </li>
        </ul>

        <plus-button *ngIf="resourcesComponent.ready && !loading.showIcons && resourcesComponent.query.q == ''
                            && resourcesComponent.selectedMainTypeDocument"
                     id="create-document-button" [placement]="'top'"
                     [preselectedType]="resourcesComponent.filterTypes && resourcesComponent.filterTypes.length > 0 ?
                        resourcesComponent.filterTypes[0] : undefined"
                     [isRecordedIn]="resourcesComponent.selectedMainTypeDocument"></plus-button>
        <loading-icon></loading-icon>
    </div>

    <div [class.col-sm-9]="!selectedDocument || !selectedDocument.resource.id"
         [class.col-sm-6]="selectedDocument && selectedDocument.resource.id" class="px-0">
        <editable-map [documents]="resourcesComponent.documents"
                      [selectedDocument]="resourcesComponent.getSelected()"
                      [mainTypeDocument]="resourcesComponent.selectedMainTypeDocument" [isEditing]="isEditing"
                      [projectDocument]="resourcesComponent.projectDocument"
                      [update]="resourcesComponent.ready" (onSelectDocument)="select($event)"
                      (onQuitEditing)="quitEditing($event)"></editable-map>
    </div>

    <div *ngIf="selectedDocument && selectedDocument.resource.id" class="col-sm-3 document-info px-0">
        <document-view [document]="selectedDocument" (onSolveConflicts)="resourcesComponent.solveConflicts($event)"
                       (onDeselect)="resourcesComponent.deselect()">

            <ngb-tabset activeId="document-view-{{activeTab}}-tab">>
                <ngb-tab id="document-view-fields-tab">
                    <ng-template ngbTabTitle>
                        <span class="mdi mdi-format-list-bulleted"></span>
                    </ng-template>
                    <ng-template ngbTabContent>

                        <button class="btn btn-link"
                                 id="document-view-button-edit-document"
                                 (click)="resourcesComponent.startEdit(selectedDocument)">
                            <span class="mdi mdi-pencil"></span>
                        </button>

                        <description-view [document]="selectedDocument"></description-view>
                        <fields-view [resource]="selectedDocument.resource"></fields-view>
                    </ng-template>
                </ngb-tab>

                <ngb-tab id="document-view-geometry-tab">
                    <ng-template ngbTabTitle>
                        <span class="mdi mdi-map" [class.empty-tab]="!selectedDocument.resource.geometry"></span>
                    </ng-template>
                    <ng-template ngbTabContent>
                        <geometry-view [document]="selectedDocument"
                                       (onEditGeometry)="resourcesComponent.startEditGeometry()"
                                       (onCreateGeometry)="resourcesComponent.createGeometry($event)">
                        </geometry-view>
                    </ng-template>
                </ngb-tab>

                <ngb-tab id="document-view-relations-tab">
                    <ng-template ngbTabTitle>
                        <span class="mdi mdi-sitemap" [class.empty-tab]="!hasRelations()"></span>
                    </ng-template>
                    <ng-template ngbTabContent>
                        <div *ngIf="!hasRelations()" class="empty-tab-info">Keine Relationen vorhanden.</div>
                        <relations-view *ngIf="hasRelations()" [resource]="selectedDocument.resource"
                                        (onRelationTargetClicked)="resourcesComponent.jumpToRelationTarget($event,
                                        'relations')">
                        </relations-view>
                    </ng-template>
                </ngb-tab>

                <ngb-tab id="document-view-images-tab">
                    <ng-template ngbTabTitle>
                        <span class="mdi mdi-image"
                              [class.empty-tab]="!selectedDocument.resource.relations['isDepictedIn']"></span>
                    </ng-template>
                    <ng-template ngbTabContent>
                        <div *ngIf="!selectedDocument.resource.relations['isDepictedIn']" class="empty-tab-info">
                            Keine Bilder vorhanden.
                        </div>
                        <thumbnail-view *ngIf="selectedDocument.resource.relations['isDepictedIn']"
                                        [imageIds]="selectedDocument.resource.relations['isDepictedIn']">
                        </thumbnail-view>
                    </ng-template>
                </ngb-tab>
            </ngb-tabset>
        </document-view>
    </div>
</div>